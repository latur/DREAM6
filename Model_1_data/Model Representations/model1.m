global as1 as2 as3 cod1 cod2 cod3 cod4 cod5 cod6 p1 p2 p3 p4 p5 p6 pp1_mrna pp2_mrna pp3_mrna pp4_mrna pp5_mrna pp6_mrna pro1 pro2 pro3 pro4 pro5 pro6 rbs1 rbs2 rbs3 rbs4 rbs5 rbs6 rs1 rs2 rs3 rs4 rs5 p1_degradation_rate p2_degradation_rate p3_degradation_rate p4_degradation_rate p5_degradation_rate p6_degradation_rate pp1_mrna_degradation_rate pp2_mrna_degradation_rate pp3_mrna_degradation_rate pp4_mrna_degradation_rate pp5_mrna_degradation_rate pp6_mrna_degradation_rate pro1_strength pro2_strength pro3_strength pro4_strength pro5_strength pro6_strength rbs1_strength rbs2_strength rbs3_strength rbs4_strength rbs5_strength rbs6_strength v1_Kd v1_h v2_Kd v2_h v3_Kd v3_h v4_Kd v4_h v5_Kd v5_h v6_Kd v6_h v7_Kd v7_h v8_Kd v8_h

as1 = 1;
as2 = 1;
as3 = 1;
cod1 = 1;
cod2 = 1;
cod3 = 1;
cod4 = 1;
cod5 = 1;
cod6 = 1;
p1 = 1;
p2 = 1;
p3 = 1;
p4 = 1;
p5 = 1;
p6 = 1;
pp1_mrna = 0;
pp2_mrna = 0;
pp3_mrna = 0;
pp4_mrna = 0;
pp5_mrna = 0;
pp6_mrna = 0;
pro1 = 1;
pro2 = 1;
pro3 = 1;
pro4 = 1;
pro5 = 1;
pro6 = 1;
rbs1 = 1;
rbs2 = 1;
rbs3 = 1;
rbs4 = 1;
rbs5 = 1;
rbs6 = 1;
rs1 = 1;
rs2 = 1;
rs3 = 1;
rs4 = 1;
rs5 = 1;

p1_degradation_rate = 1;
p2_degradation_rate = 1;
p3_degradation_rate = 1;
p4_degradation_rate = 1;
p5_degradation_rate = 1;
p6_degradation_rate = 1;
pp1_mrna_degradation_rate = 1;
pp2_mrna_degradation_rate = 1;
pp3_mrna_degradation_rate = 1;
pp4_mrna_degradation_rate = 1;
pp5_mrna_degradation_rate = 1;
pp6_mrna_degradation_rate = 1;
pro1_strength = 1;
pro2_strength = 1;
pro3_strength = 1;
pro4_strength = 1;
pro5_strength = 1;
pro6_strength = 1;
rbs1_strength = 1;
rbs2_strength = 1;
rbs3_strength = 1;
rbs4_strength = 1;
rbs5_strength = 1;
rbs6_strength = 1;
v1_Kd = 1;
v1_h = 1;
v2_Kd = 1;
v2_h = 1;
v3_Kd = 1;
v3_h = 1;
v4_Kd = 1;
v4_h = 1;
v5_Kd = 1;
v5_h = 1;
v6_Kd = 1;
v6_h = 1;
v7_Kd = 1;
v7_h = 1;
v8_Kd = 1;
v8_h = 1;

function retval = getParameters()
    global as1 as2 as3 cod1 cod2 cod3 cod4 cod5 cod6 p1 p2 p3 p4 p5 p6 pp1_mrna pp2_mrna pp3_mrna pp4_mrna pp5_mrna pp6_mrna pro1 pro2 pro3 pro4 pro5 pro6 rbs1 rbs2 rbs3 rbs4 rbs5 rbs6 rs1 rs2 rs3 rs4 rs5 p1_degradation_rate p2_degradation_rate p3_degradation_rate p4_degradation_rate p5_degradation_rate p6_degradation_rate pp1_mrna_degradation_rate pp2_mrna_degradation_rate pp3_mrna_degradation_rate pp4_mrna_degradation_rate pp5_mrna_degradation_rate pp6_mrna_degradation_rate pro1_strength pro2_strength pro3_strength pro4_strength pro5_strength pro6_strength rbs1_strength rbs2_strength rbs3_strength rbs4_strength rbs5_strength rbs6_strength v1_Kd v1_h v2_Kd v2_h v3_Kd v3_h v4_Kd v4_h v5_Kd v5_h v6_Kd v6_h v7_Kd v7_h v8_Kd v8_h
    retval = zeros(1,40);
    retval(1) = p1_degradation_rate;
    retval(2) = p2_degradation_rate;
    retval(3) = p3_degradation_rate;
    retval(4) = p4_degradation_rate;
    retval(5) = p5_degradation_rate;
    retval(6) = p6_degradation_rate;
    retval(7) = pp1_mrna_degradation_rate;
    retval(8) = pp2_mrna_degradation_rate;
    retval(9) = pp3_mrna_degradation_rate;
    retval(10) = pp4_mrna_degradation_rate;
    retval(11) = pp5_mrna_degradation_rate;
    retval(12) = pp6_mrna_degradation_rate;
    retval(13) = pro1_strength;
    retval(14) = pro2_strength;
    retval(15) = pro3_strength;
    retval(16) = pro4_strength;
    retval(17) = pro5_strength;
    retval(18) = pro6_strength;
    retval(19) = rbs1_strength;
    retval(20) = rbs2_strength;
    retval(21) = rbs3_strength;
    retval(22) = rbs4_strength;
    retval(23) = rbs5_strength;
    retval(24) = rbs6_strength;
    retval(25) = v1_Kd;
    retval(26) = v1_h;
    retval(27) = v2_Kd;
    retval(28) = v2_h;
    retval(29) = v3_Kd;
    retval(30) = v3_h;
    retval(31) = v4_Kd;
    retval(32) = v4_h;
    retval(33) = v5_Kd;
    retval(34) = v5_h;
    retval(35) = v6_Kd;
    retval(36) = v6_h;
    retval(37) = v7_Kd;
    retval(38) = v7_h;
    retval(39) = v8_Kd;
    retval(40) = v8_h;
endfunction


function retval = getVars()
    global as1 as2 as3 cod1 cod2 cod3 cod4 cod5 cod6 p1 p2 p3 p4 p5 p6 pp1_mrna pp2_mrna pp3_mrna pp4_mrna pp5_mrna pp6_mrna pro1 pro2 pro3 pro4 pro5 pro6 rbs1 rbs2 rbs3 rbs4 rbs5 rbs6 rs1 rs2 rs3 rs4 rs5 p1_degradation_rate p2_degradation_rate p3_degradation_rate p4_degradation_rate p5_degradation_rate p6_degradation_rate pp1_mrna_degradation_rate pp2_mrna_degradation_rate pp3_mrna_degradation_rate pp4_mrna_degradation_rate pp5_mrna_degradation_rate pp6_mrna_degradation_rate pro1_strength pro2_strength pro3_strength pro4_strength pro5_strength pro6_strength rbs1_strength rbs2_strength rbs3_strength rbs4_strength rbs5_strength rbs6_strength v1_Kd v1_h v2_Kd v2_h v3_Kd v3_h v4_Kd v4_h v5_Kd v5_h v6_Kd v6_h v7_Kd v7_h v8_Kd v8_h
    retval = zeros(18,1);
    retval(1) = pp1_mrna;
    retval(2) = cod1;
    retval(3) = p1;
    retval(4) = pp2_mrna;
    retval(5) = cod2;
    retval(6) = p2;
    retval(7) = pp3_mrna;
    retval(8) = cod3;
    retval(9) = p3;
    retval(10) = pp4_mrna;
    retval(11) = cod4;
    retval(12) = p4;
    retval(13) = pp5_mrna;
    retval(14) = cod5;
    retval(15) = p5;
    retval(16) = pp6_mrna;
    retval(17) = cod6;
    retval(18) = p6;
endfunction

function [] = assignParameters(newparams)
    global as1 as2 as3 cod1 cod2 cod3 cod4 cod5 cod6 p1 p2 p3 p4 p5 p6 pp1_mrna pp2_mrna pp3_mrna pp4_mrna pp5_mrna pp6_mrna pro1 pro2 pro3 pro4 pro5 pro6 rbs1 rbs2 rbs3 rbs4 rbs5 rbs6 rs1 rs2 rs3 rs4 rs5 p1_degradation_rate p2_degradation_rate p3_degradation_rate p4_degradation_rate p5_degradation_rate p6_degradation_rate pp1_mrna_degradation_rate pp2_mrna_degradation_rate pp3_mrna_degradation_rate pp4_mrna_degradation_rate pp5_mrna_degradation_rate pp6_mrna_degradation_rate pro1_strength pro2_strength pro3_strength pro4_strength pro5_strength pro6_strength rbs1_strength rbs2_strength rbs3_strength rbs4_strength rbs5_strength rbs6_strength v1_Kd v1_h v2_Kd v2_h v3_Kd v3_h v4_Kd v4_h v5_Kd v5_h v6_Kd v6_h v7_Kd v7_h v8_Kd v8_h
   p1_degradation_rate = newparams(1);
   p2_degradation_rate = newparams(2);
   p3_degradation_rate = newparams(3);
   p4_degradation_rate = newparams(4);
   p5_degradation_rate = newparams(5);
   p6_degradation_rate = newparams(6);
   pp1_mrna_degradation_rate = newparams(7);
   pp2_mrna_degradation_rate = newparams(8);
   pp3_mrna_degradation_rate = newparams(9);
   pp4_mrna_degradation_rate = newparams(10);
   pp5_mrna_degradation_rate = newparams(11);
   pp6_mrna_degradation_rate = newparams(12);
   pro1_strength = newparams(13);
   pro2_strength = newparams(14);
   pro3_strength = newparams(15);
   pro4_strength = newparams(16);
   pro5_strength = newparams(17);
   pro6_strength = newparams(18);
   rbs1_strength = newparams(19);
   rbs2_strength = newparams(20);
   rbs3_strength = newparams(21);
   rbs4_strength = newparams(22);
   rbs5_strength = newparams(23);
   rbs6_strength = newparams(24);
   v1_Kd = newparams(25);
   v1_h = newparams(26);
   v2_Kd = newparams(27);
   v2_h = newparams(28);
   v3_Kd = newparams(29);
   v3_h = newparams(30);
   v4_Kd = newparams(31);
   v4_h = newparams(32);
   v5_Kd = newparams(33);
   v5_h = newparams(34);
   v6_Kd = newparams(35);
   v6_h = newparams(36);
   v7_Kd = newparams(37);
   v7_h = newparams(38);
   v8_Kd = newparams(39);
   v8_h = newparams(40);
endfunction
global StoichiometryMatrix



StoichiometryMatrix = [     1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , -1 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ;
    0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , -1];

function DYDT = ODE(u, time)
    global as1 as2 as3 cod1 cod2 cod3 cod4 cod5 cod6 p1 p2 p3 p4 p5 p6 pp1_mrna pp2_mrna pp3_mrna pp4_mrna pp5_mrna pp6_mrna pro1 pro2 pro3 pro4 pro5 pro6 rbs1 rbs2 rbs3 rbs4 rbs5 rbs6 rs1 rs2 rs3 rs4 rs5 p1_degradation_rate p2_degradation_rate p3_degradation_rate p4_degradation_rate p5_degradation_rate p6_degradation_rate pp1_mrna_degradation_rate pp2_mrna_degradation_rate pp3_mrna_degradation_rate pp4_mrna_degradation_rate pp5_mrna_degradation_rate pp6_mrna_degradation_rate pro1_strength pro2_strength pro3_strength pro4_strength pro5_strength pro6_strength rbs1_strength rbs2_strength rbs3_strength rbs4_strength rbs5_strength rbs6_strength v1_Kd v1_h v2_Kd v2_h v3_Kd v3_h v4_Kd v4_h v5_Kd v5_h v6_Kd v6_h v7_Kd v7_h v8_Kd v8_h
    global StoichiometryMatrix
    pp1_mrna = u(1);
    cod1 = u(2);
    p1 = u(3);
    pp2_mrna = u(4);
    cod2 = u(5);
    p2 = u(6);
    pp3_mrna = u(7);
    cod3 = u(8);
    p3 = u(9);
    pp4_mrna = u(10);
    cod4 = u(11);
    p4 = u(12);
    pp5_mrna = u(13);
    cod5 = u(14);
    p5 = u(15);
    pp6_mrna = u(16);
    cod6 = u(17);
    p6 = u(18);
    as1 = ((1+((p1/v2_Kd)^v2_h))-1)/((1+((p1/v2_Kd)^v2_h)));
    as2 = ((1+((p1/v1_Kd)^v1_h))-1)/((1+((p1/v1_Kd)^v1_h)));
    as3 = ((1+((p1/v3_Kd)^v3_h))-1)/((1+((p1/v3_Kd)^v3_h)));
    cod1 = pro1_strength;
    cod2 = pro2_strength * (( as1) *(rs1));
    cod3 = pro3_strength * (( as3) *(rs4));
    cod4 = pro4_strength * (( as2) *(rs2));
    cod5 = pro5_strength * ((rs3));
    cod6 = pro6_strength * ((rs5));
    rs1 = 1.0/((1+((p6/v5_Kd)^v5_h)));
    rs2 = 1.0/((1+((p5/v8_Kd)^v8_h)));
    rs3 = 1.0/((1+((p4/v6_Kd)^v6_h)));
    rs4 = 1.0/((1+((p2/v4_Kd)^v4_h)));
    rs5 = 1.0/((1+((p4/v7_Kd)^v7_h)));
    rates = zeros(24,1);
    rates(1) = cod1;
    rates(2) = pp1_mrna_degradation_rate*pp1_mrna;
    rates(3) = rbs1_strength * pp1_mrna;
    rates(4) = p1_degradation_rate*p1;
    rates(5) = cod2;
    rates(6) = pp2_mrna_degradation_rate*pp2_mrna;
    rates(7) = rbs2_strength * pp2_mrna;
    rates(8) = p2_degradation_rate*p2;
    rates(9) = cod3;
    rates(10) = pp3_mrna_degradation_rate*pp3_mrna;
    rates(11) = rbs3_strength * pp3_mrna;
    rates(12) = p3_degradation_rate*p3;
    rates(13) = cod4;
    rates(14) = pp4_mrna_degradation_rate*pp4_mrna;
    rates(15) = rbs4_strength * pp4_mrna;
    rates(16) = p4_degradation_rate*p4;
    rates(17) = cod5;
    rates(18) = pp5_mrna_degradation_rate*pp5_mrna;
    rates(19) = rbs5_strength * pp5_mrna;
    rates(20) = p5_degradation_rate*p5;
    rates(21) = cod6;
    rates(22) = pp6_mrna_degradation_rate*pp6_mrna;
    rates(23) = rbs6_strength * pp6_mrna;
    rates(24) = p6_degradation_rate*p6;
    DYDT = StoichiometryMatrix * rates;
endfunction

